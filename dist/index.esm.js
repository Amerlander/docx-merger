var X=Object.create;var A=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,G=Object.prototype.hasOwnProperty;var H=(n,e,t)=>e in n?A(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var f=(n=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(n,{get:(e,t)=>(typeof require!="undefined"?require:e)[t]}):n)(function(n){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});var b=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var K=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of J(e))!G.call(n,r)&&r!==t&&A(n,r,{get:()=>e[r],enumerable:!(s=j(e,r))||s.enumerable});return n};var _=(n,e,t)=>(t=n!=null?X(Z(n)):{},K(e||!n||!n.__esModule?A(t,"default",{value:n,enumerable:!0}):t,n));var N=(n,e,t)=>(H(n,typeof e!="symbol"?e+"":e,t),t);var v=b((fe,R)=>{var{XMLSerializer:Q}=f("@xmldom/xmldom"),{DOMParser:U}=f("@xmldom/xmldom"),V=function(n,e){let t=new Q,s=n.map(async function(r,i){let l=await r.file("word/styles.xml").async("string"),o=new U().parseFromString(l,"text/xml"),a=o.getElementsByTagName("w:style");for(let u in a)if(/^\d+$/.test(u)&&a[u].getAttribute){let m=a[u].getAttribute("w:styleId");a[u].setAttribute("w:styleId",m+"_"+i);let p=a[u].getElementsByTagName("w:basedOn")[0];if(p){let c=p.getAttribute("w:val");p.setAttribute("w:val",c+"_"+i)}let g=a[u].getElementsByTagName("w:next")[0];if(g){let c=g.getAttribute("w:val");g.setAttribute("w:val",c+"_"+i)}let d=a[u].getElementsByTagName("w:link")[0];if(d){let c=d.getAttribute("w:val");d.setAttribute("w:val",c+"_"+i)}let w=a[u].getElementsByTagName("w:numId")[0];if(w){let c=w.getAttribute("w:val");w.setAttribute("w:val",c+i)}await E(r,i,m)}let y=l.indexOf("<w:styles ");l=l.replace(l.slice(y),t.serializeToString(o.documentElement)),r.file("word/styles.xml",l)});return Promise.all(s)},W=async function(n,e){let t=n.map(async function(s){let r=await s.file("word/styles.xml").async("string");r=r.substring(r.indexOf("<w:style "),r.indexOf("</w:styles")),e.push(r)});return Promise.all(t)},E=async function(n,e,t){let s=await n.file("word/document.xml").async("string");s=s.replace(new RegExp('w:val="'+t+'"',"g"),'w:val="'+t+"_"+e+'"'),n.file("word/document.xml",s)},Y=async function(n,e){let t=await n.file("word/styles.xml").async("string"),s=t.indexOf("<w:style "),r=t.indexOf("</w:styles>");t=t.replace(t.slice(s,r),e.join("")),n.file("word/styles.xml",t)};R.exports={mergeStyles:W,prepareStyles:V,updateStyleRel_Content:E,generateStyles:Y}});var P=b((pe,M)=>{var{XMLSerializer:ee}=f("@xmldom/xmldom"),{DOMParser:te}=f("@xmldom/xmldom"),ne=async function(n,e){let t=1,s=n.map(async function(r,i){let l=r.folder("word/media").files;for(let o in l)if(/^word\/media/.test(o)&&o.length>11){let a=t++;e[a]={},e[a].oldTarget=o,e[a].newTarget=o.replace(/[0-9]/,"_"+a).replace("word/",""),e[a].fileIndex=i,await k(r,a,e),await C(r,a,e)}});return Promise.all(s)},k=async function(n,e,t){let s=await n.file("word/_rels/document.xml.rels").async("string"),r=new te().parseFromString(s,"text/xml"),i=r.getElementsByTagName("Relationships")[0].childNodes,l=new ee;for(let a in i)/^\d+$/.test(a)&&i[a].getAttribute&&"word/"+i[a].getAttribute("Target")===t[e].oldTarget&&(t[e].oldRelID=i[a].getAttribute("Id"),i[a].setAttribute("Target",t[e].newTarget),i[a].setAttribute("Id",t[e].oldRelID+"_"+e));let o=s.indexOf("<Relationships");s=s.replace(s.slice(o),l.serializeToString(r.documentElement)),n.file("word/_rels/document.xml.rels",s)},C=async function(n,e,t){let s=await n.file("word/document.xml").async("string");s=s.replace(new RegExp(t[e].oldRelID+'"',"g"),t[e].oldRelID+"_"+e+'"'),n.file("word/document.xml",s)},se=async function(n,e,t){for(let s in e){let r=await t[e[s].fileIndex].file(e[s].oldTarget).async("uint8array");n.file("word/"+e[s].newTarget,r)}};M.exports={prepareMediaFiles:ne,updateMediaRelations:k,updateMediaContent:C,copyMediaFiles:se}});var L=b((xe,D)=>{var{XMLSerializer:F}=f("@xmldom/xmldom"),{DOMParser:S}=f("@xmldom/xmldom"),re=function(n,e){let t=n.map(async s=>{let r=await s.file("[Content_Types].xml").async("string"),l=new S().parseFromString(r,"text/xml").getElementsByTagName("Types")[0].childNodes;for(let o in l)if(/^\d+$/.test(o)&&l[o].getAttribute){let a=l[o].getAttribute("ContentType");e[a]||(e[a]=l[o].cloneNode())}});return Promise.all(t)},ie=function(n,e){let t=n.map(async s=>{let r=await s.file("word/_rels/document.xml.rels").async("string"),l=new S().parseFromString(r,"text/xml").getElementsByTagName("Relationships")[0].childNodes;for(let o in l)if(/^\d+$/.test(o)&&l[o].getAttribute){let a=l[o].getAttribute("Id");e[a]||(e[a]=l[o].cloneNode())}});return Promise.all(t)},ae=async function(n,e){let t=await n.file("[Content_Types].xml").async("string"),s=new S().parseFromString(t,"text/xml"),r=new F,i=s.documentElement.cloneNode();for(let o in e)i.appendChild(e[o]);let l=t.indexOf("<Types");t=t.replace(t.slice(l),r.serializeToString(i)),n.file("[Content_Types].xml",t)},le=async function(n,e){let t=await n.file("word/_rels/document.xml.rels").async("string"),s=new S().parseFromString(t,"text/xml"),r=new F,i=s.documentElement.cloneNode();for(let o in e)i.appendChild(e[o]);let l=t.indexOf("<Relationships");t=t.replace(t.slice(l),r.serializeToString(i)),n.file("word/_rels/document.xml.rels",t)};D.exports={mergeContentTypes:re,mergeRelations:ie,generateContentTypes:ae,generateRelations:le}});var $=b((be,q)=>{var{XMLSerializer:oe}=f("@xmldom/xmldom"),{DOMParser:ce}=f("@xmldom/xmldom"),me=function(n){let e=new oe,t=n.map(async function(s,r){let i=s.file("word/numbering.xml");if(!i)return;let l=await i.async("string"),o=new ce().parseFromString(l,"text/xml"),a=o.getElementsByTagName("w:abstractNum");for(let m in a)if(/^\d+$/.test(m)&&a[m].getAttribute){let p=a[m].getAttribute("w:abstractNumId");a[m].setAttribute("w:abstractNumId",p+r);let g=a[m].getElementsByTagName("w:pStyle");for(let c in g)if(g[c].getAttribute){let x=g[c].getAttribute("w:val");g[c].setAttribute("w:val",x+"_"+r)}let d=a[m].getElementsByTagName("w:numStyleLink");for(let c in d)if(d[c].getAttribute){let x=d[c].getAttribute("w:val");d[c].setAttribute("w:val",x+"_"+r)}let w=a[m].getElementsByTagName("w:styleLink");for(let c in w)if(w[c].getAttribute){let x=w[c].getAttribute("w:val");w[c].setAttribute("w:val",x+"_"+r)}}let y=o.getElementsByTagName("w:num");for(let m in y)if(/^\d+$/.test(m)&&y[m].getAttribute){let p=y[m].getAttribute("w:numId");y[m].setAttribute("w:numId",p+r);let g=y[m].getElementsByTagName("w:abstractNumId");for(let d in g)if(g[d].getAttribute){let w=g[d].getAttribute("w:val");g[d].setAttribute("w:val",w+r)}}let u=l.indexOf("<w:numbering ");l=l.replace(l.slice(u),e.serializeToString(o.documentElement)),s.file("word/numbering.xml",l)});return Promise.all(t)},ge=function(n,e){let t=n.map(async function(s){let r=s.file("word/numbering.xml");if(!r)return;let i=await r.async("string");i=i.substring(i.indexOf("<w:abstractNum "),i.indexOf("</w:numbering")),e.push(i)});return Promise.all(t)},de=async function(n,e){let t=n.file("word/numbering.xml");if(!t)return;let s=await t.async("string"),r=s.indexOf("<w:abstractNum "),i=s.indexOf("</w:numbering>");s=s.replace(s.slice(r,i),e.join("")),n.file("word/numbering.xml",s)};q.exports={prepareNumbering:me,mergeNumbering:ge,generateNumbering:de}});import ue from"jszip";var we=b((_e,z)=>{var I=_(v()),B=_(P()),h=_(L()),T=_($()),O=class{constructor(){N(this,"insertPageBreak",function(){let e='<w:p> 					<w:r> 						<w:br w:type="page"/> 					</w:r> 				</w:p>';this._builder.push(e)});N(this,"insertRaw",function(e){this._builder.push(e)});this._body=[],this._header=[],this._footer=[],this._pageBreak=!0,this._Basestyle="source",this._style=[],this._numbering=[],this._files=[],this._contentTypes={},this._media={},this._rel={},this._builder=this._body}async initialize(e,t){t=t||[],this._pageBreak=typeof e.pageBreak!="undefined"?!!e.pageBreak:!0,this._Basestyle=e.style||"source";for(let s of t)this._files.push(await new ue().loadAsync(s));this._files.length>0&&await this.mergeBody(this._files)}async mergeBody(e){this._builder=this._body,await h.default.mergeContentTypes(e,this._contentTypes),await B.default.prepareMediaFiles(e,this._media),await h.default.mergeRelations(e,this._rel),await T.default.prepareNumbering(e),await T.default.mergeNumbering(e,this._numbering),await I.default.prepareStyles(e,this._style),await I.default.mergeStyles(e,this._style);let t=e.map(async(s,r)=>{let i=await s.file("word/document.xml").async("string");i=i.substring(i.indexOf("<w:body>")+8),i=i.substring(0,i.indexOf("</w:body>")),i=i.substring(0,i.lastIndexOf("<w:sectPr")),this.insertRaw(i),this._pageBreak&&r<e.length-1&&this.insertPageBreak()});return Promise.all(t).then(()=>{})}async save(e){let t=this._files[0],s=await t.file("word/document.xml").async("string"),r=s.indexOf("<w:body>")+8,i=s.lastIndexOf("<w:sectPr");return s=s.replace(s.slice(r,i),this._body.join("")),await h.default.generateContentTypes(t,this._contentTypes),await B.default.copyMediaFiles(t,this._media,this._files),await h.default.generateRelations(t,this._rel),await T.default.generateNumbering(t,this._numbering),await I.default.generateStyles(t,this._style),t.file("word/document.xml",s),await t.generateAsync({type:e,compression:"DEFLATE",compressionOptions:{level:4}})}};z.exports=O});export default we();
//# sourceMappingURL=index.esm.js.map
