var X=Object.create;var A=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var G=(s,t,e)=>t in s?A(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var x=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports);var H=(s,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of J(t))!q.call(s,i)&&i!==e&&A(s,i,{get:()=>t[i],enumerable:!(n=j(t,i))||n.enumerable});return s};var h=(s,t,e)=>(e=s!=null?X(Z(s)):{},H(t||!s||!s.__esModule?A(e,"default",{value:s,enumerable:!0}):e,s));var T=(s,t,e)=>(G(s,typeof t!="symbol"?t+"":t,e),e);import{XMLSerializer as K,DOMParser as Q}from"@xmldom/xmldom";var v=x((ft,E)=>{var U=function(s,t){let e=new K,n=s.map(async function(i,r){let a=await i.file("word/styles.xml").async("string"),o=new Q().parseFromString(a,"text/xml"),l=o.getElementsByTagName("w:style");for(let u in l)if(/^\d+$/.test(u)&&l[u].getAttribute){let m=l[u].getAttribute("w:styleId");l[u].setAttribute("w:styleId",m+"_"+r);let f=l[u].getElementsByTagName("w:basedOn")[0];if(f){let c=f.getAttribute("w:val");f.setAttribute("w:val",c+"_"+r)}let g=l[u].getElementsByTagName("w:next")[0];if(g){let c=g.getAttribute("w:val");g.setAttribute("w:val",c+"_"+r)}let d=l[u].getElementsByTagName("w:link")[0];if(d){let c=d.getAttribute("w:val");d.setAttribute("w:val",c+"_"+r)}let w=l[u].getElementsByTagName("w:numId")[0];if(w){let c=w.getAttribute("w:val");w.setAttribute("w:val",c+r)}await O(i,r,m)}let y=a.indexOf("<w:styles ");a=a.replace(a.slice(y),e.serializeToString(o.documentElement)),i.file("word/styles.xml",a)});return Promise.all(n)},V=async function(s,t){let e=s.map(async function(n){let i=await n.file("word/styles.xml").async("string");i=i.substring(i.indexOf("<w:style "),i.indexOf("</w:styles")),t.push(i)});return Promise.all(e)},O=async function(s,t,e){let n=await s.file("word/document.xml").async("string");n=n.replace(new RegExp('w:val="'+e+'"',"g"),'w:val="'+e+"_"+t+'"'),s.file("word/document.xml",n)},W=async function(s,t){let e=await s.file("word/styles.xml").async("string"),n=e.indexOf("<w:style "),i=e.indexOf("</w:styles>");e=e.replace(e.slice(n,i),t.join("")),s.file("word/styles.xml",e)};E.exports={mergeStyles:V,prepareStyles:U,updateStyleRel_Content:O,generateStyles:W}});import{XMLSerializer as Y,DOMParser as tt}from"@xmldom/xmldom";var C=x((xt,P)=>{var et=async function(s,t){let e=1,n=s.map(async function(i,r){let a=i.folder("word/media").files;for(let o in a)if(/^word\/media/.test(o)&&o.length>11){let l=e++;t[l]={},t[l].oldTarget=o,t[l].newTarget=o.replace(/[0-9]/,"_"+l).replace("word/",""),t[l].fileIndex=r,await R(i,l,t),await k(i,l,t)}});return Promise.all(n)},R=async function(s,t,e){let n=await s.file("word/_rels/document.xml.rels").async("string"),i=new tt().parseFromString(n,"text/xml"),r=i.getElementsByTagName("Relationships")[0].childNodes,a=new Y;for(let l in r)/^\d+$/.test(l)&&r[l].getAttribute&&"word/"+r[l].getAttribute("Target")===e[t].oldTarget&&(e[t].oldRelID=r[l].getAttribute("Id"),r[l].setAttribute("Target",e[t].newTarget),r[l].setAttribute("Id",e[t].oldRelID+"_"+t));let o=n.indexOf("<Relationships");n=n.replace(n.slice(o),a.serializeToString(i.documentElement)),s.file("word/_rels/document.xml.rels",n)},k=async function(s,t,e){let n=await s.file("word/document.xml").async("string");n=n.replace(new RegExp(e[t].oldRelID+'"',"g"),e[t].oldRelID+"_"+t+'"'),s.file("word/document.xml",n)},nt=async function(s,t,e){for(let n in t){let i=await e[t[n].fileIndex].file(t[n].oldTarget).async("uint8array");s.file("word/"+t[n].newTarget,i)}};P.exports={prepareMediaFiles:et,updateMediaRelations:R,updateMediaContent:k,copyMediaFiles:nt}});import{XMLSerializer as D,DOMParser as _}from"@xmldom/xmldom";var F=x((ht,M)=>{var st=function(s,t){let e=s.map(async n=>{let i=await n.file("[Content_Types].xml").async("string"),a=new _().parseFromString(i,"text/xml").getElementsByTagName("Types")[0].childNodes;for(let o in a)if(/^\d+$/.test(o)&&a[o].getAttribute){let l=a[o].getAttribute("ContentType");t[l]||(t[l]=a[o].cloneNode())}});return Promise.all(e)},it=function(s,t){let e=s.map(async n=>{let i=await n.file("word/_rels/document.xml.rels").async("string"),a=new _().parseFromString(i,"text/xml").getElementsByTagName("Relationships")[0].childNodes;for(let o in a)if(/^\d+$/.test(o)&&a[o].getAttribute){let l=a[o].getAttribute("Id");t[l]||(t[l]=a[o].cloneNode())}});return Promise.all(e)},rt=async function(s,t){let e=await s.file("[Content_Types].xml").async("string"),n=new _().parseFromString(e,"text/xml"),i=new D,r=n.documentElement.cloneNode();for(let o in t)r.appendChild(t[o]);let a=e.indexOf("<Types");e=e.replace(e.slice(a),i.serializeToString(r)),s.file("[Content_Types].xml",e)},lt=async function(s,t){let e=await s.file("word/_rels/document.xml.rels").async("string"),n=new _().parseFromString(e,"text/xml"),i=new D,r=n.documentElement.cloneNode();for(let o in t)r.appendChild(t[o]);let a=e.indexOf("<Relationships");e=e.replace(e.slice(a),i.serializeToString(r)),s.file("word/_rels/document.xml.rels",e)};M.exports={mergeContentTypes:st,mergeRelations:it,generateContentTypes:rt,generateRelations:lt}});import{XMLSerializer as at,DOMParser as ot}from"@xmldom/xmldom";var $=x((St,L)=>{var ct=function(s){let t=new at,e=s.map(async function(n,i){let r=n.file("word/numbering.xml");if(!r)return;let a=await r.async("string"),o=new ot().parseFromString(a,"text/xml"),l=o.getElementsByTagName("w:abstractNum");for(let m in l)if(/^\d+$/.test(m)&&l[m].getAttribute){let f=l[m].getAttribute("w:abstractNumId");l[m].setAttribute("w:abstractNumId",f+i);let g=l[m].getElementsByTagName("w:pStyle");for(let c in g)if(g[c].getAttribute){let p=g[c].getAttribute("w:val");g[c].setAttribute("w:val",p+"_"+i)}let d=l[m].getElementsByTagName("w:numStyleLink");for(let c in d)if(d[c].getAttribute){let p=d[c].getAttribute("w:val");d[c].setAttribute("w:val",p+"_"+i)}let w=l[m].getElementsByTagName("w:styleLink");for(let c in w)if(w[c].getAttribute){let p=w[c].getAttribute("w:val");w[c].setAttribute("w:val",p+"_"+i)}}let y=o.getElementsByTagName("w:num");for(let m in y)if(/^\d+$/.test(m)&&y[m].getAttribute){let f=y[m].getAttribute("w:numId");y[m].setAttribute("w:numId",f+i);let g=y[m].getElementsByTagName("w:abstractNumId");for(let d in g)if(g[d].getAttribute){let w=g[d].getAttribute("w:val");g[d].setAttribute("w:val",w+i)}}let u=a.indexOf("<w:numbering ");a=a.replace(a.slice(u),t.serializeToString(o.documentElement)),n.file("word/numbering.xml",a)});return Promise.all(e)},mt=function(s,t){let e=s.map(async function(n){let i=n.file("word/numbering.xml");if(!i)return;let r=await i.async("string");r=r.substring(r.indexOf("<w:abstractNum "),r.indexOf("</w:numbering")),t.push(r)});return Promise.all(e)},gt=async function(s,t){let e=s.file("word/numbering.xml");if(!e)return;let n=await e.async("string"),i=n.indexOf("<w:abstractNum "),r=n.indexOf("</w:numbering>");n=n.replace(n.slice(i,r),t.join("")),s.file("word/numbering.xml",n)};L.exports={prepareNumbering:ct,mergeNumbering:mt,generateNumbering:gt}});import dt from"jszip";var ut=x((At,z)=>{var S=h(v()),N=h(C()),b=h(F()),I=h($()),B=class{constructor(){T(this,"insertPageBreak",function(){let t='<w:p> 					<w:r> 						<w:br w:type="page"/> 					</w:r> 				</w:p>';this._builder.push(t)});T(this,"insertRaw",function(t){this._builder.push(t)});this._body=[],this._header=[],this._footer=[],this._pageBreak=!0,this._Basestyle="source",this._style=[],this._numbering=[],this._files=[],this._contentTypes={},this._media={},this._rel={},this._builder=this._body}async initialize(t,e){e=e||[],this._pageBreak=typeof t.pageBreak!="undefined"?!!t.pageBreak:!0,this._Basestyle=t.style||"source";for(let n of e)this._files.push(await new dt().loadAsync(n));this._files.length>0&&await this.mergeBody(this._files)}async mergeBody(t){this._builder=this._body,await b.default.mergeContentTypes(t,this._contentTypes),await N.default.prepareMediaFiles(t,this._media),await b.default.mergeRelations(t,this._rel),await I.default.prepareNumbering(t),await I.default.mergeNumbering(t,this._numbering),await S.default.prepareStyles(t,this._style),await S.default.mergeStyles(t,this._style);let e=t.map(async(n,i)=>{let r=await n.file("word/document.xml").async("string");r=r.substring(r.indexOf("<w:body>")+8),r=r.substring(0,r.indexOf("</w:body>")),r=r.substring(0,r.lastIndexOf("<w:sectPr")),this.insertRaw(r),this._pageBreak&&i<t.length-1&&this.insertPageBreak()});return Promise.all(e).then(()=>{})}async save(t){let e=this._files[0],n=await e.file("word/document.xml").async("string"),i=n.indexOf("<w:body>")+8,r=n.lastIndexOf("<w:sectPr");return n=n.replace(n.slice(i,r),this._body.join("")),await b.default.generateContentTypes(e,this._contentTypes),await N.default.copyMediaFiles(e,this._media,this._files),await b.default.generateRelations(e,this._rel),await I.default.generateNumbering(e,this._numbering),await S.default.generateStyles(e,this._style),e.file("word/document.xml",n),await e.generateAsync({type:t,compression:"DEFLATE",compressionOptions:{level:4}})}};z.exports=B});export default ut();
//# sourceMappingURL=index.esm.js.map
