var z=Object.create;var T=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty;var G=(s,e,t)=>e in s?T(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var h=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var H=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of j(e))!Z.call(s,r)&&r!==t&&T(s,r,{get:()=>e[r],enumerable:!(n=X(e,r))||n.enumerable});return s};var x=(s,e,t)=>(t=s!=null?z(J(s)):{},H(e||!s||!s.__esModule?T(t,"default",{value:s,enumerable:!0}):t,s));var A=(s,e,t)=>(G(s,typeof e!="symbol"?e+"":e,t),t);var R=h((ue,E)=>{var{XMLSerializer:K}=require("@xmldom/xmldom"),{DOMParser:Q}=require("@xmldom/xmldom"),U=function(s,e){let t=new K,n=s.map(async function(r,i){let l=await r.file("word/styles.xml").async("string"),o=new Q().parseFromString(l,"text/xml"),a=o.getElementsByTagName("w:style");for(let u in a)if(/^\d+$/.test(u)&&a[u].getAttribute){let m=a[u].getAttribute("w:styleId");a[u].setAttribute("w:styleId",m+"_"+i);let f=a[u].getElementsByTagName("w:basedOn")[0];if(f){let c=f.getAttribute("w:val");f.setAttribute("w:val",c+"_"+i)}let g=a[u].getElementsByTagName("w:next")[0];if(g){let c=g.getAttribute("w:val");g.setAttribute("w:val",c+"_"+i)}let d=a[u].getElementsByTagName("w:link")[0];if(d){let c=d.getAttribute("w:val");d.setAttribute("w:val",c+"_"+i)}let w=a[u].getElementsByTagName("w:numId")[0];if(w){let c=w.getAttribute("w:val");w.setAttribute("w:val",c+i)}await O(r,i,m)}let y=l.indexOf("<w:styles ");l=l.replace(l.slice(y),t.serializeToString(o.documentElement)),r.file("word/styles.xml",l)});return Promise.all(n)},V=async function(s,e){let t=s.map(async function(n){let r=await n.file("word/styles.xml").async("string");r=r.substring(r.indexOf("<w:style "),r.indexOf("</w:styles")),e.push(r)});return Promise.all(t)},O=async function(s,e,t){let n=await s.file("word/document.xml").async("string");n=n.replace(new RegExp('w:val="'+t+'"',"g"),'w:val="'+t+"_"+e+'"'),s.file("word/document.xml",n)},W=async function(s,e){let t=await s.file("word/styles.xml").async("string"),n=t.indexOf("<w:style "),r=t.indexOf("</w:styles>");t=t.replace(t.slice(n,r),e.join("")),s.file("word/styles.xml",t)};E.exports={mergeStyles:V,prepareStyles:U,updateStyleRel_Content:O,generateStyles:W}});var M=h((we,C)=>{var{XMLSerializer:Y}=require("@xmldom/xmldom"),{DOMParser:ee}=require("@xmldom/xmldom"),te=async function(s,e){let t=1,n=s.map(async function(r,i){let l=r.folder("word/media").files;for(let o in l)if(/^word\/media/.test(o)&&o.length>11){let a=t++;e[a]={},e[a].oldTarget=o,e[a].newTarget=o.replace(/[0-9]/,"_"+a).replace("word/",""),e[a].fileIndex=i,await v(r,a,e),await k(r,a,e)}});return Promise.all(n)},v=async function(s,e,t){let n=await s.file("word/_rels/document.xml.rels").async("string"),r=new ee().parseFromString(n,"text/xml"),i=r.getElementsByTagName("Relationships")[0].childNodes,l=new Y;for(let a in i)/^\d+$/.test(a)&&i[a].getAttribute&&"word/"+i[a].getAttribute("Target")===t[e].oldTarget&&(t[e].oldRelID=i[a].getAttribute("Id"),i[a].setAttribute("Target",t[e].newTarget),i[a].setAttribute("Id",t[e].oldRelID+"_"+e));let o=n.indexOf("<Relationships");n=n.replace(n.slice(o),l.serializeToString(r.documentElement)),s.file("word/_rels/document.xml.rels",n)},k=async function(s,e,t){let n=await s.file("word/document.xml").async("string");n=n.replace(new RegExp(t[e].oldRelID+'"',"g"),t[e].oldRelID+"_"+e+'"'),s.file("word/document.xml",n)},ne=async function(s,e,t){for(let n in e){let r=await t[e[n].fileIndex].file(e[n].oldTarget).async("uint8array");s.file("word/"+e[n].newTarget,r)}};C.exports={prepareMediaFiles:te,updateMediaRelations:v,updateMediaContent:k,copyMediaFiles:ne}});var D=h((ye,F)=>{var{XMLSerializer:P}=require("@xmldom/xmldom"),{DOMParser:_}=require("@xmldom/xmldom"),se=function(s,e){let t=s.map(async n=>{let r=await n.file("[Content_Types].xml").async("string"),l=new _().parseFromString(r,"text/xml").getElementsByTagName("Types")[0].childNodes;for(let o in l)if(/^\d+$/.test(o)&&l[o].getAttribute){let a=l[o].getAttribute("ContentType");e[a]||(e[a]=l[o].cloneNode())}});return Promise.all(t)},re=function(s,e){let t=s.map(async n=>{let r=await n.file("word/_rels/document.xml.rels").async("string"),l=new _().parseFromString(r,"text/xml").getElementsByTagName("Relationships")[0].childNodes;for(let o in l)if(/^\d+$/.test(o)&&l[o].getAttribute){let a=l[o].getAttribute("Id");e[a]||(e[a]=l[o].cloneNode())}});return Promise.all(t)},ie=async function(s,e){let t=await s.file("[Content_Types].xml").async("string"),n=new _().parseFromString(t,"text/xml"),r=new P,i=n.documentElement.cloneNode();for(let o in e)i.appendChild(e[o]);let l=t.indexOf("<Types");t=t.replace(t.slice(l),r.serializeToString(i)),s.file("[Content_Types].xml",t)},ae=async function(s,e){let t=await s.file("word/_rels/document.xml.rels").async("string"),n=new _().parseFromString(t,"text/xml"),r=new P,i=n.documentElement.cloneNode();for(let o in e)i.appendChild(e[o]);let l=t.indexOf("<Relationships");t=t.replace(t.slice(l),r.serializeToString(i)),s.file("word/_rels/document.xml.rels",t)};F.exports={mergeContentTypes:se,mergeRelations:re,generateContentTypes:ie,generateRelations:ae}});var q=h((fe,L)=>{var{XMLSerializer:le}=require("@xmldom/xmldom"),{DOMParser:oe}=require("@xmldom/xmldom"),ce=function(s){let e=new le,t=s.map(async function(n,r){let i=n.file("word/numbering.xml");if(!i)return;let l=await i.async("string"),o=new oe().parseFromString(l,"text/xml"),a=o.getElementsByTagName("w:abstractNum");for(let m in a)if(/^\d+$/.test(m)&&a[m].getAttribute){let f=a[m].getAttribute("w:abstractNumId");a[m].setAttribute("w:abstractNumId",f+r);let g=a[m].getElementsByTagName("w:pStyle");for(let c in g)if(g[c].getAttribute){let p=g[c].getAttribute("w:val");g[c].setAttribute("w:val",p+"_"+r)}let d=a[m].getElementsByTagName("w:numStyleLink");for(let c in d)if(d[c].getAttribute){let p=d[c].getAttribute("w:val");d[c].setAttribute("w:val",p+"_"+r)}let w=a[m].getElementsByTagName("w:styleLink");for(let c in w)if(w[c].getAttribute){let p=w[c].getAttribute("w:val");w[c].setAttribute("w:val",p+"_"+r)}}let y=o.getElementsByTagName("w:num");for(let m in y)if(/^\d+$/.test(m)&&y[m].getAttribute){let f=y[m].getAttribute("w:numId");y[m].setAttribute("w:numId",f+r);let g=y[m].getElementsByTagName("w:abstractNumId");for(let d in g)if(g[d].getAttribute){let w=g[d].getAttribute("w:val");g[d].setAttribute("w:val",w+r)}}let u=l.indexOf("<w:numbering ");l=l.replace(l.slice(u),e.serializeToString(o.documentElement)),n.file("word/numbering.xml",l)});return Promise.all(t)},me=function(s,e){let t=s.map(async function(n){let r=n.file("word/numbering.xml");if(!r)return;let i=await r.async("string");i=i.substring(i.indexOf("<w:abstractNum "),i.indexOf("</w:numbering")),e.push(i)});return Promise.all(t)},ge=async function(s,e){let t=s.file("word/numbering.xml");if(!t)return;let n=await t.async("string"),r=n.indexOf("<w:abstractNum "),i=n.indexOf("</w:numbering>");n=n.replace(n.slice(r,i),e.join("")),s.file("word/numbering.xml",n)};L.exports={prepareNumbering:ce,mergeNumbering:me,generateNumbering:ge}});var $=x(require("jszip")),S=x(R()),N=x(M()),b=x(D()),I=x(q());var B=class{constructor(){A(this,"insertPageBreak",function(){let e='<w:p> 					<w:r> 						<w:br w:type="page"/> 					</w:r> 				</w:p>';this._builder.push(e)});A(this,"insertRaw",function(e){this._builder.push(e)});this._body=[],this._header=[],this._footer=[],this._pageBreak=!0,this._Basestyle="source",this._style=[],this._numbering=[],this._files=[],this._contentTypes={},this._media={},this._rel={},this._builder=this._body}async initialize(e,t){t=t||[],this._pageBreak=typeof e.pageBreak!="undefined"?!!e.pageBreak:!0,this._Basestyle=e.style||"source";for(let n of t)this._files.push(await new $.default().loadAsync(n));this._files.length>0&&await this.mergeBody(this._files)}async mergeBody(e){this._builder=this._body,await b.default.mergeContentTypes(e,this._contentTypes),await N.default.prepareMediaFiles(e,this._media),await b.default.mergeRelations(e,this._rel),await I.default.prepareNumbering(e),await I.default.mergeNumbering(e,this._numbering),await S.default.prepareStyles(e,this._style),await S.default.mergeStyles(e,this._style);let t=e.map(async(n,r)=>{let i=await n.file("word/document.xml").async("string");i=i.substring(i.indexOf("<w:body>")+8),i=i.substring(0,i.indexOf("</w:body>")),i=i.substring(0,i.lastIndexOf("<w:sectPr")),this.insertRaw(i),this._pageBreak&&r<e.length-1&&this.insertPageBreak()});return Promise.all(t).then(()=>{})}async save(e){let t=this._files[0],n=await t.file("word/document.xml").async("string"),r=n.indexOf("<w:body>")+8,i=n.lastIndexOf("<w:sectPr");return n=n.replace(n.slice(r,i),this._body.join("")),await b.default.generateContentTypes(t,this._contentTypes),await N.default.copyMediaFiles(t,this._media,this._files),await b.default.generateRelations(t,this._rel),await I.default.generateNumbering(t,this._numbering),await S.default.generateStyles(t,this._style),t.file("word/document.xml",n),await t.generateAsync({type:e,compression:"DEFLATE",compressionOptions:{level:4}})}};module.exports=B;
//# sourceMappingURL=index.cjs.js.map
