var M=Object.create;var g=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var k=(r,e)=>{for(var t in e)g(r,t,{get:e[t],enumerable:!0})},w=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of B(e))!D.call(r,n)&&n!==t&&g(r,n,{get:()=>e[n],enumerable:!(i=A(e,n))||i.enumerable});return r};var y=(r,e,t)=>(t=r!=null?M(z(r)):{},w(e||!r||!r.__esModule?g(t,"default",{value:r,enumerable:!0}):t,r)),v=r=>w(g({},"__esModule",{value:!0}),r);var $={};k($,{default:()=>Z});module.exports=v($);var F=y(require("jszip"));var m=require("@xmldom/xmldom"),x=async function(r,e){let t=r.map(async i=>{let n=await i.file("word/styles.xml").async("string"),l=new m.DOMParser().parseFromString(n,"text/xml").documentElement.childNodes;for(let s=0;s<l.length;s++)if(l[s].nodeType===1){let a=l[s].getAttribute("w:styleId");e[a]||(e[a]=l[s].cloneNode(!0))}});return Promise.all(t)},u=async function(r,e){let t=r.map(async i=>{let n=await i.file("word/styles.xml").async("string"),o=new m.DOMParser().parseFromString(n,"text/xml"),l=new m.XMLSerializer,s=o.documentElement.cloneNode();for(let f in e)s.appendChild(e[f]);let a=n.indexOf("<w:styles");n=n.replace(n.slice(a),l.serializeToString(s)),i.file("word/styles.xml",n)});return Promise.all(t)};var h=async function(r,e){let t=await r.file("word/styles.xml").async("string"),i=t.indexOf("<w:style "),n=t.indexOf("</w:styles>");t=t.replace(t.slice(i,n),e.join("")),r.file("word/styles.xml",t)};var b=y(require("jszip")),S=require("@xmldom/xmldom");async function _(r,e){for(let t of r){let n=(await new b.default().loadAsync(t)).folder("word/media");n&&n.forEach((o,l)=>{e[o]=l})}}async function N(r,e,t){let i=r.folder("word/media");if(!i)throw new Error("Media folder not found in the zip");for(let[n,o]of Object.entries(e)){let l=await o.async("blob");i.file(n,l)}}var c=require("@xmldom/xmldom"),T=function(r,e){let t=r.map(async i=>{let n=await i.file("[Content_Types].xml").async("string"),l=new c.DOMParser().parseFromString(n,"text/xml").getElementsByTagName("Types")[0].childNodes;for(let s in l)if(/^\d+$/.test(s)&&l[s].getAttribute){let a=l[s].getAttribute("ContentType");e[a]||(e[a]=l[s].cloneNode())}});return Promise.all(t)},I=async function(r,e){let t=r.map(async i=>{let n=await i.file("word/_rels/document.xml.rels").async("string"),l=new c.DOMParser().parseFromString(n,"text/xml").documentElement.childNodes;for(let s=0;s<l.length;s++)if(l[s].nodeType===1){let a=l[s].getAttribute("Id");e[a]||(e[a]=l[s].cloneNode())}});return Promise.all(t)},R=async function(r,e){let t=await r.file("[Content_Types].xml").async("string"),i=new c.DOMParser().parseFromString(t,"text/xml"),n=new c.XMLSerializer,o=i.documentElement.cloneNode();for(let s in e)o.appendChild(e[s]);let l=t.indexOf("<Types");t=t.replace(t.slice(l),n.serializeToString(o)),r.file("[Content_Types].xml",t)},O=async function(r,e){let t=await r.file("word/_rels/document.xml.rels").async("string"),i=new c.DOMParser().parseFromString(t,"text/xml"),n=new c.XMLSerializer,o=i.documentElement.cloneNode();for(let s in e)o.appendChild(e[s]);let l=t.indexOf("<Relationships");t=t.replace(t.slice(l),n.serializeToString(o)),r.file("word/_rels/document.xml.rels",t)};var q=require("jszip"),d=require("@xmldom/xmldom");async function P(r,e){let t=r.map(async i=>{let n=await i.file("word/numbering.xml").async("string"),l=new d.DOMParser().parseFromString(n,"text/xml").documentElement.childNodes;for(let s=0;s<l.length;s++)if(l[s].nodeType===1){let a=l[s].getAttribute("w:abstractNumId");e[a]||(e[a]=l[s].cloneNode(!0))}e.push(n)});return Promise.all(t)}async function C(r,e){let t=r.map(async i=>{let n=await i.file("word/numbering.xml").async("string"),o=new d.DOMParser().parseFromString(n,"text/xml"),l=new d.XMLSerializer,s=o.documentElement.cloneNode();for(let f in e)s.appendChild(e[f]);let a=n.indexOf("<w:numbering");n=n.replace(n.slice(a),l.serializeToString(s)),i.file("word/numbering.xml",n)});return Promise.all(t)}async function E(r,e){let t=r.file("word/numbering.xml");if(!t)throw new Error("Numbering file not found in the zip");let i=await t.async("string"),n=i.indexOf("<w:abstractNum "),o=i.indexOf("</w:numbering>");i=i.replace(i.slice(n,o),e.join("")),r.file("word/numbering.xml",i)}var p=class{constructor(e={},t=[]){this._body=[],this._header=[],this._footer=[],this._pageBreak=typeof e.pageBreak!="undefined"?!!e.pageBreak:!0,this._Basestyle=e.style||"source",this._style=[],this._numbering=[],this._files=[],this._contentTypes={},this._media={},this._rel={},this._builder=this._body,this.initialize(e,t)}async initialize(e,t){for(let i of t){let n=i instanceof Uint8Array?i.buffer:i,o=await new F.default().loadAsync(n);this._files.push(o)}this._files.length>0&&await this.mergeBody(this._files)}insertPageBreak(){let e='<w:p>                     <w:r>                         <w:br w:type="page"/>                     </w:r>                 </w:p>';this._builder.push(e)}insertSectionBreak(){let e='<w:p>                     <w:pPr>                         <w:sectPr>                             <w:type w:val="nextPage"/>                         </w:sectPr>                     </w:pPr>                 </w:p>';this._builder.push(e)}insertRaw(e){this._builder.push(e)}async mergeBody(e){this._builder=this._body,await T(e,this._contentTypes),await _(e,this._media),await I(e,this._rel),await P(e,this._numbering),await C(e,this._numbering),await x(e,this._style),await u(e,this._style);let t=e.map(async(i,n)=>{let o=await i.file("word/document.xml").async("string");o=o.substring(o.indexOf("<w:body>")+8),o=o.substring(0,o.indexOf("</w:body>")),o=o.substring(0,o.lastIndexOf("<w:sectPr")),this.insertRaw(o),this._pageBreak&&n<e.length-1&&this.insertSectionBreak()});return Promise.all(t).then(()=>{})}async save(e,t){let i=this._files[0];if(!i||!i.file)throw new Error("JSZip file not properly loaded");let n=await i.file("word/document.xml").async("string"),o=n.indexOf("<w:body>")+8,l=n.lastIndexOf("<w:sectPr");n=n.replace(n.slice(o,l),this._body.join("")),await R(i,this._contentTypes),await N(i,this._media,this._files),await O(i,this._rel),await E(i,this._numbering),await h(i,this._style),i.file("word/document.xml",n);let s=await i.generateAsync({type:e,compression:"DEFLATE",compressionOptions:{level:4}});return t&&t(s),s}},Z=p;
//# sourceMappingURL=index.cjs.js.map
